<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Event and epoch handling • eegUtils</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Event and epoch handling">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eegUtils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/eegUtils.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_structures.html">A guide to eegUtils data structures</a></li>
    <li><a class="dropdown-item" href="../articles/epoch-handling.html">Event and epoch handling</a></li>
    <li><a class="dropdown-item" href="../articles/linear_modelling/linear_modelling.html">Linear Modelling</a></li>
    <li><a class="dropdown-item" href="../articles/time-frequency-analysis.html">Frequency analysis</a></li>
    <li><a class="dropdown-item" href="../articles/topoplot/topoplot.html">Building a topographical plot</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/craddm/eegUtils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Event and epoch handling</h1>
                        <h4 data-toc-skip class="author">Matt
Craddock</h4>
            
            <h4 data-toc-skip class="date">2024-10-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/craddm/eegUtils/blob/main/vignettes/epoch-handling.Rmd" class="external-link"><code>vignettes/epoch-handling.Rmd</code></a></small>
      <div class="d-none name"><code>epoch-handling.Rmd</code></div>
    </div>

    
    
<p>In this example, we’re going to look at how to handle epoching and
events. To start, we have continuous data from 70 channels sampled at
512 Hz, average referenced, and bandpass filtered from 0.1 to 40 Hz.
There is a complete table of all of the events imported with the data.
We can use that table to form epochs.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eeg_example</span></span>
<span><span class="fu"><a href="../reference/events.html">events</a></span><span class="op">(</span><span class="va">eeg_example</span><span class="op">)</span></span></code></pre></div>
<p>There are 18 unique trigger codes, which we can check with
<code><a href="../reference/list_events.html">list_events()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/list_events.html">list_events</a></span><span class="op">(</span><span class="va">eeg_example</span><span class="op">)</span></span></code></pre></div>
<p>In this experiment, six of those triggers correspond to condition
codes.</p>
<table class="table">
<thead><tr class="header">
<th>Trigger</th>
<th>Semantic type</th>
<th>Spatial frequency</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>207</td>
<td>Match</td>
<td>High</td>
</tr>
<tr class="even">
<td>208</td>
<td>Match</td>
<td>Low</td>
</tr>
<tr class="odd">
<td>213</td>
<td>Mismatch</td>
<td>High</td>
</tr>
<tr class="even">
<td>215</td>
<td>Mismatch</td>
<td>Low</td>
</tr>
<tr class="odd">
<td>219</td>
<td>Nonsense</td>
<td>High</td>
</tr>
<tr class="even">
<td>222</td>
<td>Nonsense</td>
<td>Low</td>
</tr>
</tbody>
</table>
<p>We can use the <code><a href="../reference/epoch_data.html">epoch_data()</a></code> function to create epochs
around each of these triggers, and label those epochs accordingly. In
this example, I’ll label each trigger using hierarchically coded event
tags, simultaneously giving each condition of semantic type and spatial
frequency separated by a “/” symbol.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_epochs</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/epoch_data.html">epoch_data</a></span><span class="op">(</span><span class="va">eeg_example</span>,</span>
<span>             events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">207</span>, </span>
<span>                        <span class="fl">208</span>,</span>
<span>                        <span class="fl">213</span>,</span>
<span>                        <span class="fl">215</span>,</span>
<span>                        <span class="fl">219</span>,</span>
<span>                        <span class="fl">222</span><span class="op">)</span>,</span>
<span>             epoch_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Match/HSF"</span>,</span>
<span>                              <span class="st">"Match/LSF"</span>,</span>
<span>                              <span class="st">"Mismatch/HSF"</span>,</span>
<span>                              <span class="st">"Mismatch/LSF"</span>,</span>
<span>                              <span class="st">"Nonsense/HSF"</span>,</span>
<span>                              <span class="st">"Nonsense/LSF"</span><span class="op">)</span>,</span>
<span>             time_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.2</span>, <span class="fl">.6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/events.html">events</a></span><span class="op">(</span><span class="va">example_epochs</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/epochs.html">epochs</a></span><span class="op">(</span><span class="va">example_epochs</span><span class="op">)</span></span></code></pre></div>
<p>As can be seen, this modifies the epochs structure so that it now
labels each epoch accordingly. Since we have hierarchically encoded
event tags, an easy way to split that into multiple columns is using the
<code>separate()</code> function from the <code>tidyr</code>
package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/epochs.html">epochs</a></span><span class="op">(</span><span class="va">example_epochs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="fu"><a href="../reference/epochs.html">epochs</a></span><span class="op">(</span><span class="va">example_epochs</span><span class="op">)</span>,</span>
<span>                                          col <span class="op">=</span> <span class="va">epoch_labels</span>,</span>
<span>                                          into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Semantics"</span>, <span class="st">"SF"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/epochs.html">epochs</a></span><span class="op">(</span><span class="va">example_epochs</span><span class="op">)</span></span></code></pre></div>
<p>Any columns in the <code>epochs</code> structure are included when
converting to a data frame. This has a lot of advantages for plotting;
many plotting commands now allow you to use <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code>
and <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid()</a></code> from <code>ggplot2</code> to facet on any
of the columns from the epoch structure. Note that for performance
reasons, facetting must be explicitly allowed using
<code>allow_facets = TRUE</code>, since <code>ggplot2</code>’s
<code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary()</a></code> function can be extremely slow.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_butterfly.html">plot_butterfly</a></span><span class="op">(</span><span class="va">example_epochs</span>,</span>
<span>               legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               baseline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>               allow_facets <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">SF</span><span class="op">)</span></span></code></pre></div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matt Craddock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
