<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Filter EEG data — eeg_filter • eegUtils</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Filter EEG data — eeg_filter"><meta property="og:description" content="Perform IIR or FIR filtering on input EEG data of class eeg_data or
eeg_epochs. WARNING: with epoched data, epoch boundaries are currently
ignored, which can result in minor edge artifacts."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eegUtils</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.7.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/eegUtils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data_structures.html">A guide to eegUtils data structures</a>
    </li>
    <li>
      <a href="../articles/epoch-handling.html">Event and epoch handling</a>
    </li>
    <li>
      <a href="../articles/linear_modelling/linear_modelling.html">Linear Modelling</a>
    </li>
    <li>
      <a href="../articles/single_subj_N170/N170_single_subject.html">Getting started with eegUtils and the N170</a>
    </li>
    <li>
      <a href="../articles/time-frequency-analysis.html">Frequency analysis</a>
    </li>
    <li>
      <a href="../articles/topoplot/topoplot.html">Building a topographical plot</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/craddm/eegUtils/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter EEG data</h1>
    <small class="dont-index">Source: <a href="https://github.com/craddm/eegUtils/blob/HEAD/R/filtering.R" class="external-link"><code>R/filtering.R</code></a></small>
    <div class="hidden name"><code>eeg_filter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform IIR or FIR filtering on input EEG data of class <code>eeg_data</code> or
<code>eeg_epochs</code>. WARNING: with epoched data, epoch boundaries are currently
ignored, which can result in minor edge artifacts.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eeg_filter</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'eeg_data'</span></span>
<span><span class="fu">eeg_filter</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  low_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  high_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter_order <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  trans_bw <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"fir"</span>,</span>
<span>  window <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  demean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'eeg_epochs'</span></span>
<span><span class="fu">eeg_filter</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  low_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  high_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter_order <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  trans_bw <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"fir"</span>,</span>
<span>  window <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  demean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'eeg_group'</span></span>
<span><span class="fu">eeg_filter</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  low_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  high_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter_order <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  trans_bw <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"fir"</span>,</span>
<span>  window <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  demean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>An <code>eeg_data</code> or <code>eeg_epochs</code> object to be filtered.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters.</p></dd>


<dt id="arg-low-freq">low_freq<a class="anchor" aria-label="anchor" href="#arg-low-freq"></a></dt>
<dd><p>Low cutoff frequency.</p></dd>


<dt id="arg-high-freq">high_freq<a class="anchor" aria-label="anchor" href="#arg-high-freq"></a></dt>
<dd><p>High cutoff frequency.</p></dd>


<dt id="arg-filter-order">filter_order<a class="anchor" aria-label="anchor" href="#arg-filter-order"></a></dt>
<dd><p>Defaults to "auto", which automatically estimates filter
order for the specified filter characteristics (defaults to 4 if method =
"iir").</p></dd>


<dt id="arg-trans-bw">trans_bw<a class="anchor" aria-label="anchor" href="#arg-trans-bw"></a></dt>
<dd><p>Transition bandwidth of the filter. "auto" or an integer.
"auto" attempts to determine a suitable transition bandwidth using the
heuristic given below. Ignored if method = "iir".</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>"fir" (Finite Impulse Response) or "iir" (Infinite Impulse
Response). Defaults to "fir".</p></dd>


<dt id="arg-window">window<a class="anchor" aria-label="anchor" href="#arg-window"></a></dt>
<dd><p>Windowing function to use (FIR filtering only). Defaults to
"hamming"; currently only "hamming" available.</p></dd>


<dt id="arg-demean">demean<a class="anchor" aria-label="anchor" href="#arg-demean"></a></dt>
<dd><p>Remove DC component (i.e. channel/epoch mean) before filtering.
Defaults to TRUE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of the original class with signals filtered according to
the user's specifications</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>low_freq and high_freq are the low and high cutoff frequencies. Pass low freq
or high freq alone to perform high-pass or low-pass filtering respectively.
For band-pass or band-stop filters, pass both low_freq and high_freq.</p>
<p>If low_freq &lt; high_freq, bandpass filtering is performed.</p>
<p>If low_freq &gt; high_freq, bandstop filtering is performed.</p>
<p>Note that it is recommended to first zero-mean the signal using either
channel means or by-channel epoch means.</p>
<p>The function allows parallelization using the <code>future</code> package, e.g. using
<code>plan(multisession)</code></p>
    </div>
    <div id="fir-versus-iir-filtering">
    <h2>FIR versus IIR filtering</h2>
    <p>Finite Impulse Response (FIR) filtering is
performed using an overlap-add FFT method. Note that this only performs a
single-pass; the data is shifted back in time by the group delay of the
filter to compensate for the phase delay imposed by the linear filtering
process. Infinite Impulse Response (IIR) filtering is performed using a
two-pass (once forwards, once reversed) method to correct for phase
alignment. Note that the Butterworth filter designs used here can become
numerically unstable with only a small increase in filter order. For most
purposes, use FIR filters.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="plot_psd.html">plot_psd</a></span><span class="op">(</span><span class="fu">eeg_filter</span><span class="op">(</span><span class="va">demo_epochs</span>, low_freq <span class="op">=</span> <span class="fl">1</span>, high_freq <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Band-pass FIR filter from 1 - 30 Hz</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Transition bandwidth: 1 Hz</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filter order: 424</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Power Spectral Density using Welch's method.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> FFT length: 256</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Segment length: 84</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points: 42 (50% overlap)</span>
<span class="r-plt img"><img src="eeg_filter-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="plot_psd.html">plot_psd</a></span><span class="op">(</span><span class="fu">eeg_filter</span><span class="op">(</span><span class="va">demo_epochs</span>, low_freq <span class="op">=</span> <span class="fl">12</span>, high_freq <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Band-stop FIR filter from 8 - 12 Hz.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Transition bandwidth: 2 Hz</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filter order: 212</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Power Spectral Density using Welch's method.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> FFT length: 256</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Segment length: 84</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points: 42 (50% overlap)</span>
<span class="r-plt img"><img src="eeg_filter-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="plot_psd.html">plot_psd</a></span><span class="op">(</span><span class="fu">eeg_filter</span><span class="op">(</span><span class="va">demo_epochs</span>, low_freq <span class="op">=</span> <span class="fl">12</span>, high_freq <span class="op">=</span> <span class="fl">8</span>, method <span class="op">=</span> <span class="st">"iir"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Band-stop IIR filter from 8 - 12 Hz.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Effective filter order: 4 (two-pass)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Power Spectral Density using Welch's method.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> FFT length: 256</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Segment length: 84</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points: 42 (50% overlap)</span>
<span class="r-plt img"><img src="eeg_filter-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Matt Craddock.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

