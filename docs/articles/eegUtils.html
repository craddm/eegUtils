<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EEG Utils â€¢ eegUtils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="EEG Utils">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eegUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/eegUtils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_structures.html">A guide to eegUtils data structures</a>
    </li>
    <li>
      <a href="../articles/epoch-handling.html">Event and epoch handling</a>
    </li>
    <li>
      <a href="../articles/time-frequency-analysis.html">Frequency analysis</a>
    </li>
    <li>
      <a href="../articles/topoplot.html">Building a topographical plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/craddm/eegUtils">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>EEG Utils</h1>
                        <h4 class="author">Matt Craddock</h4>
            
            <h4 class="date">2019-11-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/craddm/eegUtils/blob/master/vignettes/eegUtils.Rmd"><code>vignettes/eegUtils.Rmd</code></a></small>
      <div class="hidden name"><code>eegUtils.Rmd</code></div>

    </div>

    
    
<p><code>eegUtils</code> is a package for performing basic EEG preprocessing and plotting of EEG data. Many of these functions are wrappers around existing R functions to make them behave in consistent ways and produce output that is more amenable to many of the subsequent steps in EEG analysis.</p>
<p>The package implements custom objects to contain EEG data and associated metadata. Some of its functions depend on data being stored in this format, but part of the philosophy of the package is that any object stored in the custom <code>eeg_data</code> and associated formats will always be convertible to a standard data.frame or tibble for subsequent use in whatever way the user desires. Plotting functions will typically work on both <code>eeg_data</code> objects and standard formats, while more complex processing functions will require an <code>eeg_data</code> or related custom object (such as <code>eeg_tfr</code>).</p>
<div id="basic-eeg-processing" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-eeg-processing" class="anchor"></a>Basic EEG processing</h2>
<p>There is currently suport for loading raw data in the .BDF (typically BioSemi), .CNT (32-bit; associated with Neuroscan), and .vhdr/.vmrk/.dat Brain Vision Analyzer 2.0 file formats using the <code><a href="../reference/import_raw.html">import_raw()</a></code> command. Loading data in these formats results in an <code>eeg_data</code> object - a structure that contains the raw data and a variety of metadata.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(eegUtils)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; Make sure to check for the latest development version at https://github.com/craddm/eegUtils!</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt; Attaching package: 'eegUtils'</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt; The following object is masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt;     filter</span></a>
<a class="sourceLine" id="cb1-8" title="8">eeg_example &lt;-<span class="st"> </span><span class="kw"><a href="../reference/import_raw.html">import_raw</a></span>(<span class="st">"F:</span><span class="ch">\\</span><span class="st">Dropbox</span><span class="ch">\\</span><span class="st">EEGData</span><span class="ch">\\</span><span class="st">RawEEGData</span><span class="ch">\\</span><span class="st">BasicCat</span><span class="ch">\\</span><span class="st">S2B1.bdf"</span>)</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; Importing F:\Dropbox\EEGData\RawEEGData\BasicCat\S2B1.bdf as BDF</span></a>
<a class="sourceLine" id="cb1-10" title="10">eeg_example</a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt; EEG data</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#&gt; Number of channels   : 72 </span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#&gt; Electrode names      : A1 A2 A3 A4 A5 A6 A7 A8 A9 A10 A11 A12 A13 A14 A15 A16 A17 A18 A19 A20 A21 A22 A23 A24 A25 A26 A27 A28 A29 A30 A31 A32 B1 B2 B3 B4 B5 B6 B7 B8 B9 B10 B11 B12 B13 B14 B15 B16 B17 B18 B19 B20 B21 B22 B23 B24 B25 B26 B27 B28 B29 B30 B31 B32 EXG1 EXG2 EXG3 EXG4 EXG5 EXG6 EXG7 EXG8 </span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#&gt; Sampling rate        : 512 Hz</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">#&gt; Reference        :</span></a></code></pre></div>
<p>The data itself is stored in the <code>signals</code> data frame within the object; the timing of events is stored in the <code>events</code> data frame, and timings for each sample are stored in the <code>timings</code> data frame. Times are stored in samples and seconds.</p>
<p>A common first step would be to rereference the data, which can be done using the <code><a href="../reference/eeg_reference.html">reref_eeg()</a></code> command. By default, if no electrodes are specified, the data will be referenced to a common average. The median rather than the mean can be used by specifiying <code>robust == TRUE</code>. Electrodes can also be excluded from the average reference calculation; they will nevertheless still be referenced to the same reference as the other channels.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">eeg_example &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eeg_reference.html">eeg_reference</a></span>(eeg_example, <span class="dt">ref_chans =</span> <span class="st">"average"</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">eeg_example &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eeg_reference.html">eeg_reference</a></span>(eeg_example, <span class="dt">ref_chans =</span> <span class="st">"average"</span>, <span class="dt">robust =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">eeg_example &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eeg_reference.html">eeg_reference</a></span>(eeg_example, <span class="dt">ref_chans =</span> <span class="st">"average"</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">                             <span class="dt">exclude =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"EXG7"</span>, <span class="st">"EXG8"</span>),</a>
<a class="sourceLine" id="cb2-5" title="5">                             <span class="dt">robust =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>EEGLAB can be loaded using the <code><a href="../reference/import_set.html">import_set()</a></code> command. The command detects whether the data is epoched or not and, by default, arranges the data in the <code>eeg_data</code> or <code>eeg_epochs</code> format.</p>
<p>Filtering can be performed using the <code><a href="../reference/eeg_filter.html">eeg_filter()</a></code> command. This uses IIR or FIR filters to modify the frequency response of the signal, remove low or high frequency fluctuations as requested.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">eeg_example &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eeg_filter.html">eeg_filter</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb3-2" title="2">                          <span class="dt">method =</span> <span class="st">"iir"</span>,</a>
<a class="sourceLine" id="cb3-3" title="3">                          <span class="dt">low_freq =</span> <span class="fl">.1</span>,</a>
<a class="sourceLine" id="cb3-4" title="4">                          <span class="dt">high_freq =</span> <span class="dv">40</span>,</a>
<a class="sourceLine" id="cb3-5" title="5">                          <span class="dt">filter_order =</span> <span class="dv">3</span>) <span class="co">#specify a bandpass filter</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; Band-pass IIR filter from 0.1 - 40 Hz</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; Effective filter order: 6 (two-pass)</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; Removing channel means...</span></a></code></pre></div>
</div>
<div id="creating-epochs" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-epochs" class="anchor"></a>Creating epochs</h2>
<p>Data can be epoched around events/triggers using <code><a href="../reference/epoch_data.html">epoch_data()</a></code>, which outputs an <code>eeg_epochs</code> object. A list of the event triggers found in the data can be retrieved using <code><a href="../reference/list_events.html">list_events()</a></code>. In this case weâ€™ll epoch around event code 201.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="../reference/list_events.html">list_events</a></span>(eeg_example)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt;    event_type</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; 1          18</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; 2         123</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; 3         125</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; 4         201</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; 5         202</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; 6          50</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; 7           7</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; 8          51</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt; 9          21</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt; 10         12</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt; 11          6</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt; 12         14</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt; 13         99</span></a>
<a class="sourceLine" id="cb4-16" title="16">eeg_example &lt;-<span class="st"> </span><span class="kw"><a href="../reference/epoch_data.html">epoch_data</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb4-17" title="17">                          <span class="dt">events =</span> <span class="dv">201</span>,</a>
<a class="sourceLine" id="cb4-18" title="18">                          <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">3</span>, <span class="fl">.75</span>))</a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; Adjusting output limits to match sampling rate.</span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt; Output limits:  -0.30078125 0.748046875</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt; Removing channel means per epoch...</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt; Creating 78 epochs.</span></a></code></pre></div>
</div>
<div id="plotting" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h2>
<p><code>eeg_epochs</code> can then be plotted using <code><a href="../reference/plot_butterfly.html">plot_butterfly()</a></code> or <code><a href="../reference/plot_timecourse.html">plot_timecourse()</a></code>. Both <code><a href="../reference/plot_butterfly.html">plot_butterfly()</a></code> and <code><a href="../reference/plot_timecourse.html">plot_timecourse()</a></code> average over epochs. <code><a href="../reference/plot_timecourse.html">plot_timecourse()</a></code> will also average over electrodes - all electrodes if none are specified, or over any specified electrodes. Baseline correction can also be applied at this point if desired. Baseline correction can also be applied using <code><a href="../reference/rm_baseline.html">rm_baseline()</a></code>, or for plotting only using the <code>baseline</code> parameter in the plotting call.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="../reference/plot_butterfly.html">plot_butterfly</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb5-2" title="2">               <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">2</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb5-3" title="3">               <span class="dt">legend =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="eegUtils_files/figure-html/do-plots-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="../reference/plot_butterfly.html">plot_butterfly</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb6-2" title="2">               <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">2</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb6-3" title="3">               <span class="dt">legend =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb6-4" title="4">               <span class="dt">baseline =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>, <span class="dv">0</span>))</a></code></pre></div>
<p><img src="eegUtils_files/figure-html/do-plots-2.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="../reference/plot_timecourse.html">plot_timecourse</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb7-2" title="2">                <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">2</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb7-3" title="3">                <span class="dt">baseline =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb7-4" title="4">                <span class="dt">electrode =</span> <span class="st">"A30"</span>) <span class="co"># Plot POz</span></a></code></pre></div>
<p><img src="eegUtils_files/figure-html/do-plots-3.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="../reference/plot_timecourse.html">plot_timecourse</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb8-2" title="2">                <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">2</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb8-3" title="3">                <span class="dt">baseline =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb8-4" title="4">                <span class="dt">electrode =</span> <span class="st">"B6"</span>) <span class="co"># Plot Fz</span></a></code></pre></div>
<p><img src="eegUtils_files/figure-html/do-plots-4.png" width="700"></p>
<p>Standard channel locations can be added using the <code><a href="../reference/electrode_locations.html">electrode_locations()</a></code> command. This function supplies default locations for over 300 typical locations accroding to the 10-05 system. There are several specific montages provided, and can be specified using the <code>montage</code> parameter. In this case, the data was recorded using Biosemi with alpha-numeric channel labels (e.g.Â A1 rather than Fp1), which are built-in with <code>biosemi64alpha</code>. <code><a href="../reference/topoplot.html">topoplot()</a></code> can then be used to plot topographical representation of selected data. Note that it is not compulsory to use locations from electrode_locations(); if the data has x and y columns when it is a data frame, or added to <code>chan_info</code> element of the <code>eeg_data</code>/<code>eeg_epochs</code> object, then those will be used.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">eeg_example &lt;-<span class="st"> </span><span class="kw"><a href="../reference/electrode_locations.html">electrode_locations</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb9-2" title="2">                                   <span class="dt">montage =</span> <span class="st">"biosemi64alpha"</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt; Electrodes not found: EXG1 EXG2 EXG3 EXG4 EXG5 EXG6 EXG7 EXG8</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw"><a href="../reference/topoplot.html">topoplot</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb9-5" title="5">         <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">1</span>, <span class="fl">.2</span>))</a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt; Using electrode locations from data.</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt; Warning in topoplot.data.frame(data, time_lim = time_lim, limits =</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; limits, : Removing channels with no location.</span></a></code></pre></div>
<p><img src="eegUtils_files/figure-html/do-topo-1.png" width="700"></p>
<p>Note that one electrode (Fp1/A1) was malunctioning during the the recording. We can interpolate that using spherical spline interpolation (<code><a href="../reference/interp_elecs.html">interp_elecs()</a></code>).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">eeg_example &lt;-<span class="st"> </span><span class="kw"><a href="../reference/interp_elecs.html">interp_elecs</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb10-2" title="2">                            <span class="dt">bad_elecs =</span> <span class="st">"A1"</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; Coords missing for electrodes EXG1 EXG2 EXG3 EXG4 EXG5 EXG6 EXG7 EXG8</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw"><a href="../reference/topoplot.html">topoplot</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb10-5" title="5">         <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">1</span>, <span class="fl">.2</span>))</a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; Using electrode locations from data.</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; Warning in topoplot.data.frame(data, time_lim = time_lim, limits =</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; limits, : Removing channels with no location.</span></a></code></pre></div>
<p><img src="eegUtils_files/figure-html/inter-1.png" width="700"></p>
<p>At any point, <code>eegUtils</code> objects can be transformed into data frames for use with functions that donâ€™t natively support them.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb11-11" title="11">eeg_example <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="st">  </span><span class="kw"><a href="../reference/select_epochs.html">select_epochs</a></span>(<span class="dt">epoch_no =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="st">  </span><span class="kw"><a href="../reference/select_elecs.html">select_elecs</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A29"</span>, <span class="st">"B6"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="dt">long =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> amplitude)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> epoch), <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,</a>
<a class="sourceLine" id="cb11-18" title="18">               <span class="dt">geom =</span> <span class="st">"line"</span>,</a>
<a class="sourceLine" id="cb11-19" title="19">               <span class="dt">size =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb11-20" title="20">               <span class="kw">aes</span>(<span class="dt">colour =</span> electrode)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>electrode) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-22" title="22"><span class="st">  </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="eegUtils_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
</div>
<div id="tidyverse-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#tidyverse-functions" class="anchor"></a>Tidyverse functions</h1>
<p>In addition, there are overloaded versions of some <code>dplyr</code> functions that operate on the <code>signals</code> element of <code>eeg_data</code> and <code>eeg_epochs</code> objects. For example, <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> can be used to choose particular electrodes, and <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> can be used to filter out epochs or timepoints. <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> can be used to add new columns (e.g.Â creating ROIs from multiple electrodes).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">eeg_example <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">occipital =</span> (A29 <span class="op">+</span><span class="st"> </span>A27 <span class="op">+</span><span class="st"> </span>B32) <span class="op">/</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(A29, B6, occipital) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(epoch <span class="op">&lt;=</span><span class="st"> </span><span class="dv">60</span>, time <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="dt">long =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> amplitude)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> epoch), <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,</a>
<a class="sourceLine" id="cb12-9" title="9">               <span class="dt">geom =</span> <span class="st">"line"</span>,</a>
<a class="sourceLine" id="cb12-10" title="10">               <span class="dt">size =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb12-11" title="11">               <span class="kw">aes</span>(<span class="dt">colour =</span> electrode)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>electrode) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="st">  </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="eegUtils_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#basic-eeg-processing">Basic EEG processing</a></li>
      <li><a href="#creating-epochs">Creating epochs</a></li>
      <li><a href="#plotting">Plotting</a></li>
      <li><a href="#tidyverse-functions">Tidyverse functions</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matt Craddock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
