<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Event and epoch handling • eegUtils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Event and epoch handling">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eegUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/eegUtils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_structures.html">A guide to eegUtils data structures</a>
    </li>
    <li>
      <a href="../articles/epoch-handling.html">Event and epoch handling</a>
    </li>
    <li>
      <a href="../articles/time-frequency-analysis.html">Frequency analysis</a>
    </li>
    <li>
      <a href="../articles/topoplot.html">Building a topographical plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/craddm/eegUtils">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="epoch-handling_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Event and epoch handling</h1>
                        <h4 class="author">Matt Craddock</h4>
            
            <h4 class="date">2020-04-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/craddm/eegUtils/blob/master/vignettes/epoch-handling.Rmd"><code>vignettes/epoch-handling.Rmd</code></a></small>
      <div class="hidden name"><code>epoch-handling.Rmd</code></div>

    </div>

    
    
<p>In this example, we’re going to look at how to handle epoching and events. To start, we have continuous data from 70 channels sampled at 512 Hz, average referenced, and bandpass filtered from 0.1 to 40 Hz. There is a complete table of all of the events imported with the data. We can use that table to form epochs.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>eeg_example</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">events</span>(eeg_example)</span></code></pre></div>
<p>There are 18 unique trigger codes, which we can check with <code>list_events()</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">list_events</span>(eeg_example)</span></code></pre></div>
<p>In this experiment, six of those triggers correspond to condition codes.</p>
<table class="table">
<thead><tr class="header">
<th>Trigger</th>
<th>Semantic type</th>
<th>Spatial frequency</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>207</td>
<td>Match</td>
<td>High</td>
</tr>
<tr class="even">
<td>208</td>
<td>Match</td>
<td>Low</td>
</tr>
<tr class="odd">
<td>213</td>
<td>Mismatch</td>
<td>High</td>
</tr>
<tr class="even">
<td>215</td>
<td>Mismatch</td>
<td>Low</td>
</tr>
<tr class="odd">
<td>219</td>
<td>Nonsense</td>
<td>High</td>
</tr>
<tr class="even">
<td>222</td>
<td>Nonsense</td>
<td>Low</td>
</tr>
</tbody>
</table>
<p>We can use the <code>epoch_data()</code> function to create epochs around each of these triggers, and label those epochs accordingly. In this example, I’ll label each trigger using hierarchically coded event tags, simultaneously giving each condition of semantic type and spatial frequency separated by a “/” symbol.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>example_epochs &lt;-<span class="st"> </span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="st">  </span><span class="kw">epoch_data</span>(eeg_example,</span>
<span id="cb3-3"><a href="#cb3-3"></a>             <span class="dt">events =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">207</span>, </span>
<span id="cb3-4"><a href="#cb3-4"></a>                        <span class="dv">208</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>                        <span class="dv">213</span>,</span>
<span id="cb3-6"><a href="#cb3-6"></a>                        <span class="dv">215</span>,</span>
<span id="cb3-7"><a href="#cb3-7"></a>                        <span class="dv">219</span>,</span>
<span id="cb3-8"><a href="#cb3-8"></a>                        <span class="dv">222</span>),</span>
<span id="cb3-9"><a href="#cb3-9"></a>             <span class="dt">epoch_labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Match/HSF"</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>                              <span class="st">"Match/LSF"</span>,</span>
<span id="cb3-11"><a href="#cb3-11"></a>                              <span class="st">"Mismatch/HSF"</span>,</span>
<span id="cb3-12"><a href="#cb3-12"></a>                              <span class="st">"Mismatch/LSF"</span>,</span>
<span id="cb3-13"><a href="#cb3-13"></a>                              <span class="st">"Nonsense/HSF"</span>,</span>
<span id="cb3-14"><a href="#cb3-14"></a>                              <span class="st">"Nonsense/LSF"</span>),</span>
<span id="cb3-15"><a href="#cb3-15"></a>             <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">2</span>, <span class="fl">.6</span>))</span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="kw">events</span>(example_epochs)</span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="kw">epochs</span>(example_epochs)</span></code></pre></div>
<p>As can be seen, this modifies the epochs structure so that it now labels each epoch accordingly. Since we have hierarchically encoded event tags, an easy way to split that into multiple columns is using the <code>separate()</code> function from the <code>tidyr</code> package.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">epochs</span>(example_epochs) &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span>(<span class="kw">epochs</span>(example_epochs),</span>
<span id="cb4-2"><a href="#cb4-2"></a>                                          <span class="dt">col =</span> epoch_labels,</span>
<span id="cb4-3"><a href="#cb4-3"></a>                                          <span class="dt">into =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Semantics"</span>, <span class="st">"SF"</span>))</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">epochs</span>(example_epochs)</span></code></pre></div>
<p>Any columns in the <code>epochs</code> structure are included when converting to a data frame. This has a lot of advantages for plotting; many plotting commands now allow you to use <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code> from <code>ggplot2</code> to facet on any of the columns from the epoch structure. Note that for performance reasons, facetting must be explicitly allowed using <code>allow_facets = TRUE</code>, since <code>ggplot2</code>’s <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code> function can be extremely slow.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">plot_butterfly</span>(example_epochs,</span>
<span id="cb5-3"><a href="#cb5-3"></a>               <span class="dt">legend =</span> <span class="ot">FALSE</span>,</span>
<span id="cb5-4"><a href="#cb5-4"></a>               <span class="dt">baseline =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-5"><a href="#cb5-5"></a>               <span class="dt">allow_facets =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>SF)</span></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matt Craddock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
