<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EEG Utils • eegUtils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="EEG Utils">
<meta property="og:description" content="eegUtils">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eegUtils</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.7.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/eegUtils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_structures.html">A guide to eegUtils data structures</a>
    </li>
    <li>
      <a href="../articles/epoch-handling.html">Event and epoch handling</a>
    </li>
    <li>
      <a href="../articles/linear_modelling/linear_modelling.html">Linear Modelling</a>
    </li>
    <li>
      <a href="../articles/single_subj_N170/N170_single_subject.html">Getting started with eegUtils and the N170</a>
    </li>
    <li>
      <a href="../articles/time-frequency-analysis.html">Frequency analysis</a>
    </li>
    <li>
      <a href="../articles/topoplot/topoplot.html">Building a topographical plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/craddm/eegUtils/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>EEG Utils</h1>
                        <h4 data-toc-skip class="author">Matt
Craddock</h4>
            
            <h4 data-toc-skip class="date">2022-06-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/craddm/eegUtils/blob/HEAD/vignettes/eegUtils.Rmd" class="external-link"><code>vignettes/eegUtils.Rmd</code></a></small>
      <div class="hidden name"><code>eegUtils.Rmd</code></div>

    </div>

    
    
<p><code>eegUtils</code> is a package for performing basic EEG
preprocessing and plotting of EEG data. Many of these functions are
wrappers around existing R functions to make them behave in consistent
ways and produce output that is more amenable to many of the subsequent
steps in EEG analysis.</p>
<p>The package implements custom objects to contain EEG data and
associated metadata. Some of its functions depend on data being stored
in this format, but part of the philosophy of the package is that any
object stored in the custom <code>eeg_data</code> and associated formats
will always be convertible to a standard data.frame or tibble for
subsequent use in whatever way the user desires. Plotting functions will
typically work on both <code>eeg_data</code> objects and standard
formats, while more complex processing functions will require an
<code>eeg_data</code> or related custom object (such as
<code>eeg_tfr</code>).</p>
<div class="section level2">
<h2 id="basic-eeg-processing">Basic EEG processing<a class="anchor" aria-label="anchor" href="#basic-eeg-processing"></a>
</h2>
<p>There is currently suport for loading raw data in the .BDF (typically
BioSemi), .CNT (32-bit; associated with Neuroscan), and .vhdr/.vmrk/.dat
Brain Vision Analyzer 2.0 file formats using the
<code><a href="../reference/import_raw.html">import_raw()</a></code> command. Loading data in these formats results
in an <code>eeg_data</code> object - a structure that contains the raw
data and a variety of metadata.</p>
<p>In this experiment, participants had to covertly attend to either the
left or right visual field as indicated by a visual cue (an arrow
pointing left or right). Around 1-1.5 seconds after the cue, a target -
a Gabor patch - could appear in either the left or right visual field.
The task was to determing whether the target patch showed a vertical or
a horizontal grating. 80% of the time, the target appeared in the cued
location.</p>
<p>You can find the file “Matt-task-spatcue.bdf” on <a href="https://osf.io/dxhjb/" class="external-link">Open Science Framework</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/craddm/eegUtils" class="external-link">eegUtils</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'eegUtils'</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"Matt-task-spatcue.bdf"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">temp_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">temp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_dir</span>, <span class="st">"Matt-task-spatcue.bdf"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="st">"https://osf.io/hy5wq/download"</span>,
                <span class="va">temp_file</span>,
                mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span>
  <span class="va">eeg_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_raw.html">import_raw</a></span><span class="op">(</span><span class="va">temp_file</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">eeg_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_raw.html">import_raw</a></span><span class="op">(</span><span class="st">"Matt-task-spatcue.bdf"</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#&gt; Importing Matt-task-spatcue.bdf as BDF</span>
<span class="va">eeg_example</span>
<span class="co">#&gt; EEG data</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of channels   : 72 </span>
<span class="co">#&gt; Electrode names      : Fp1 AF7 AF3 F1 F3 F5 F7 FT7 FC5 FC3 FC1 C1 C3 C5 T7 TP7 CP5 CP3 CP1 P1 P3 P5 P7 P9 PO7 PO3 O1 Iz Oz POz Pz CPz Fpz Fp2 AF8 AF4 AFz Fz F2 F4 F6 F8 FT8 FC6 FC4 FC2 FCz Cz C2 C4 C6 T8 TP8 CP6 CP4 CP2 P2 P4 P6 P8 P10 PO8 PO4 O2 EXG1 EXG2 EXG3 EXG4 EXG5 EXG6 EXG7 EXG8 </span>
<span class="co">#&gt; Sampling rate        : 256 Hz</span>
<span class="co">#&gt; Reference        : </span>
<span class="co">#&gt; Signal length: 0 1468.996 seconds</span></code></pre></div>
<p>This data was recorded at 1024 Hz (downsampled here already to 256
Hz) using a BioSemi ActiveTwo amplifier and active electrodes. There
were 64 electrodes positioned and named according to the 10-05
international system. A few additional electrodes (EXG1-EXG4) placed
around the eyes to record eye movements, and two further reference
electrodes placed on the left and right mastoids (EXG5 and EXG6). EXG7
and EXG8 are empty channels, with no electrodes attached.</p>
</div>
<div class="section level2">
<h2 id="referencing">Referencing<a class="anchor" aria-label="anchor" href="#referencing"></a>
</h2>
<p>A common first step would be to rereference the data, which can be
done using the <code><a href="../reference/eeg_reference.html">eeg_reference()</a></code> command. By default, if no
electrodes are specified, the data will be referenced to a common
average, calculated from all the electrodes in the data. First we’ll
remove the two empty channels, EXG7 and EXG8, using the
<code><a href="../reference/select_elecs.html">select_elecs()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">eeg_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_elecs.html">select_elecs</a></span><span class="op">(</span><span class="va">eeg_example</span>,
                            electrode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EXG7"</span>, <span class="st">"EXG8"</span><span class="op">)</span>,
                            keep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">eeg_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eeg_reference.html">eeg_reference</a></span><span class="op">(</span><span class="va">eeg_example</span>,
                             ref_chans <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>
<span class="va">eeg_example</span>
<span class="co">#&gt; EEG data</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of channels   : 70 </span>
<span class="co">#&gt; Electrode names      : Fp1 AF7 AF3 F1 F3 F5 F7 FT7 FC5 FC3 FC1 C1 C3 C5 T7 TP7 CP5 CP3 CP1 P1 P3 P5 P7 P9 PO7 PO3 O1 Iz Oz POz Pz CPz Fpz Fp2 AF8 AF4 AFz Fz F2 F4 F6 F8 FT8 FC6 FC4 FC2 FCz Cz C2 C4 C6 T8 TP8 CP6 CP4 CP2 P2 P4 P6 P8 P10 PO8 PO4 O2 EXG1 EXG2 EXG3 EXG4 EXG5 EXG6 </span>
<span class="co">#&gt; Sampling rate        : 256 Hz</span>
<span class="co">#&gt; Reference        : average </span>
<span class="co">#&gt; Signal length: 0 1468.996 seconds</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="filtering">Filtering<a class="anchor" aria-label="anchor" href="#filtering"></a>
</h2>
<p>Filtering can be performed using the <code><a href="../reference/eeg_filter.html">eeg_filter()</a></code>
command. This uses IIR or FIR filters to modify the frequency response
of the signal, removing low or high frequency fluctuations as requested.
For speed, we’ll use “iir” filtering here to perform bandpass filtering
with a high-pass filter at .1 Hz and a low-pass filter at 40 Hz. We’ll
also plot the power spectral density of the data before and after
filtering, using the <code><a href="../reference/plot_psd.html">plot_psd()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_psd.html">plot_psd</a></span><span class="op">(</span><span class="va">eeg_example</span>, 
         freq_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span><span class="op">)</span>,
         legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Removing channel means...</span>
<span class="co">#&gt; Computing Power Spectral Density using Welch's method.</span>
<span class="co">#&gt;  FFT length:  2048 </span>
<span class="co">#&gt;  Segment length:  2048 </span>
<span class="co">#&gt;  Overlapping points:  1024 ( 50 %)</span></code></pre></div>
<p><img src="eegUtils_files/figure-html/filt-butter-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">eeg_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eeg_filter.html">eeg_filter</a></span><span class="op">(</span><span class="va">eeg_example</span>,
                          method <span class="op">=</span> <span class="st">"iir"</span>,
                          low_freq <span class="op">=</span> <span class="fl">.1</span>,
                          high_freq <span class="op">=</span> <span class="fl">40</span>,
                          filter_order <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># specify a bandpass filter</span>
<span class="co">#&gt; Band-pass IIR filter from 0.1 - 40 Hz</span>
<span class="co">#&gt; Effective filter order: 8 (two-pass)</span>
<span class="co">#&gt; Removing channel means...</span>
<span class="fu"><a href="../reference/plot_psd.html">plot_psd</a></span><span class="op">(</span><span class="va">eeg_example</span>, 
         freq_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span><span class="op">)</span>,
         legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Removing channel means...</span>
<span class="co">#&gt; Computing Power Spectral Density using Welch's method.</span>
<span class="co">#&gt;  FFT length:  2048 </span>
<span class="co">#&gt;  Segment length:  2048 </span>
<span class="co">#&gt;  Overlapping points:  1024 ( 50 %)</span></code></pre></div>
<p><img src="eegUtils_files/figure-html/filt-butter-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="creating-epochs">Creating epochs<a class="anchor" aria-label="anchor" href="#creating-epochs"></a>
</h2>
<p>Data can be epoched around events/triggers using
<code><a href="../reference/epoch_data.html">epoch_data()</a></code>, which outputs an <code>eeg_epochs</code>
object. A list of the event triggers found in the data can be retrieved
using <code>list_events(eeg_example)</code>, or more comprehensively,
the events structure can be retrieved using
<code>events(eeg_example)</code>. In this case, we’ll epoch around
events <code>120</code> and <code>122</code>. These events correspond to
the onset of a visual target on the left and right of fixation
respectively, for validly cued trials only.</p>
<p>We can specify the length of epochs around the trigger using the
<code>time_lim</code> argument, and label each epoch using
<code>epoch_labels</code>. Here we also specify that the data should be
baseline corrected using the average of the timepoints from -.1s to 0s
(stimulus onset).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/list_events.html">list_events</a></span><span class="op">(</span><span class="va">eeg_example</span><span class="op">)</span>
<span class="co">#&gt;    event_type</span>
<span class="co">#&gt; 1         254</span>
<span class="co">#&gt; 2         100</span>
<span class="co">#&gt; 3          60</span>
<span class="co">#&gt; 4         200</span>
<span class="co">#&gt; 5         122</span>
<span class="co">#&gt; 6          20</span>
<span class="co">#&gt; 7          62</span>
<span class="co">#&gt; 8         120</span>
<span class="co">#&gt; 9          25</span>
<span class="co">#&gt; 10        132</span>
<span class="co">#&gt; 11        130</span>
<span class="va">epoched_example</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/epoch_data.html">epoch_data</a></span><span class="op">(</span>
    <span class="va">eeg_example</span>,
    events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">120</span>,
               <span class="fl">122</span><span class="op">)</span>,
    epoch_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"valid_left"</span>,
                     <span class="st">"valid_right"</span><span class="op">)</span>,
    time_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.1</span>, <span class="fl">.4</span><span class="op">)</span>,
    baseline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.1</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; Adjusting output limits to match sampling rate.</span>
<span class="co">#&gt; Output limits:  -0.1015625 0.3984375</span>
<span class="co">#&gt; Baseline: -0.1 - 0s</span>
<span class="co">#&gt; Creating 256 epochs.</span></code></pre></div>
<p>After epoching, use the <code><a href="../reference/epochs.html">epochs()</a></code> function to check the
meta-information for this data and its epochs.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/epochs.html">epochs</a></span><span class="op">(</span><span class="va">epoched_example</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 256 × 5</span></span>
<span class="co">#&gt;    epoch participant_id recording         event_type epoch_labels</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 <span style="color: #BB0000;">NA</span>             Matt-task-spatcue        122 valid_right </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2 <span style="color: #BB0000;">NA</span>             Matt-task-spatcue        120 valid_left  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3 <span style="color: #BB0000;">NA</span>             Matt-task-spatcue        122 valid_right </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4 <span style="color: #BB0000;">NA</span>             Matt-task-spatcue        122 valid_right </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5 <span style="color: #BB0000;">NA</span>             Matt-task-spatcue        120 valid_left  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6 <span style="color: #BB0000;">NA</span>             Matt-task-spatcue        122 valid_right </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7 <span style="color: #BB0000;">NA</span>             Matt-task-spatcue        120 valid_left  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8 <span style="color: #BB0000;">NA</span>             Matt-task-spatcue        120 valid_left  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9 <span style="color: #BB0000;">NA</span>             Matt-task-spatcue        122 valid_right </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10 <span style="color: #BB0000;">NA</span>             Matt-task-spatcue        122 valid_right </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 246 more rows</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<p><code>eeg_epochs</code> can then be plotted using
<code><a href="../reference/plot_butterfly.html">plot_butterfly()</a></code> or <code><a href="../reference/plot_timecourse.html">plot_timecourse()</a></code>. Both
<code><a href="../reference/plot_butterfly.html">plot_butterfly()</a></code> and <code><a href="../reference/plot_timecourse.html">plot_timecourse()</a></code> average
over epochs. <code><a href="../reference/plot_timecourse.html">plot_timecourse()</a></code> will also average over
electrodes - all electrodes if none are specified, or over any specified
electrodes. Baseline correction can also be applied for plotting only
using the <code>baseline</code> parameter in the plotting call.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_butterfly.html">plot_butterfly</a></span><span class="op">(</span><span class="va">epoched_example</span>,
               legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Creating epochs based on combinations of variables: participant_id epoch_labels</span></code></pre></div>
<p><img src="eegUtils_files/figure-html/do-plots-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_butterfly.html">plot_butterfly</a></span><span class="op">(</span><span class="va">epoched_example</span>,
               time_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.1</span>, <span class="fl">.3</span><span class="op">)</span>,
               legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Creating epochs based on combinations of variables: participant_id epoch_labels</span></code></pre></div>
<p><img src="eegUtils_files/figure-html/do-plots-2.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_timecourse.html">plot_timecourse</a></span><span class="op">(</span><span class="va">epoched_example</span>,
                electrode <span class="op">=</span> <span class="st">"POz"</span><span class="op">)</span> <span class="co"># Plot POz</span>
<span class="co">#&gt; Creating epochs based on combinations of variables: participant_id epoch_labels</span></code></pre></div>
<p><img src="eegUtils_files/figure-html/do-plots-3.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_timecourse.html">plot_timecourse</a></span><span class="op">(</span><span class="va">epoched_example</span>,
                electrode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POz"</span>, <span class="st">"Oz"</span>, <span class="st">"O1"</span>, <span class="st">"O2"</span><span class="op">)</span><span class="op">)</span> <span class="co"># average over four occipital electrodes</span>
<span class="co">#&gt; Creating epochs based on combinations of variables: participant_id epoch_labels</span></code></pre></div>
<p><img src="eegUtils_files/figure-html/do-plots-4.png" width="700"></p>
<p>Standard channel locations can be added using the
<code><a href="../reference/electrode_locations.html">electrode_locations()</a></code> command. This function supplies
default locations for over 300 typical locations accroding to the 10-05
system. There are several specific montages provided that can be
specified using the <code>montage</code> parameter.</p>
<p>You can inspect the added locations using
<code><a href="../reference/channels.html">channels()</a></code>.</p>
<p><code><a href="../reference/topoplot.html">topoplot()</a></code> can then be used to plot a topographical
representation of selected data. Note that it is not compulsory to use
locations from <code><a href="../reference/electrode_locations.html">electrode_locations()</a></code>; if the data has x and
y columns when it is a data frame, or added to <code>chan_info</code>
element of the <code>eeg_data</code>/<code>eeg_epochs</code> object,
then those will be used.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epoched_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/electrode_locations.html">electrode_locations</a></span><span class="op">(</span><span class="va">epoched_example</span>,
                                       overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Electrodes not found: EXG1 EXG2 EXG3 EXG4 EXG5 EXG6</span>
<span class="fu"><a href="../reference/channels.html">channels</a></span><span class="op">(</span><span class="va">epoched_example</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 70 × 9</span></span>
<span class="co">#&gt;    electrode radius theta   phi cart_x cart_y cart_z     x     y</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Fp1            1   -<span style="color: #BB0000;">94</span>   -<span style="color: #BB0000;">71</span>  -<span style="color: #BB0000;">29.4</span>   83.9  -<span style="color: #BB0000;">6.99</span> -<span style="color: #BB0000;">30.6</span>  88.9</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> AF7            1   -<span style="color: #BB0000;">97</span>   -<span style="color: #BB0000;">51</span>  -<span style="color: #BB0000;">54.8</span>   68.6 -<span style="color: #BB0000;">10.6</span>  -<span style="color: #BB0000;">61.0</span>  75.4</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> AF3            1   -<span style="color: #BB0000;">76</span>   -<span style="color: #BB0000;">66</span>  -<span style="color: #BB0000;">33.7</span>   76.8  21.2  -<span style="color: #BB0000;">30.9</span>  69.4</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> F1             1   -<span style="color: #BB0000;">46</span>   -<span style="color: #BB0000;">64</span>  -<span style="color: #BB0000;">27.5</span>   56.9  60.3  -<span style="color: #BB0000;">20.2</span>  41.3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> F3             1   -<span style="color: #BB0000;">60</span>   -<span style="color: #BB0000;">47</span>  -<span style="color: #BB0000;">50.2</span>   53.1  42.2  -<span style="color: #BB0000;">40.9</span>  43.9</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> F5             1   -<span style="color: #BB0000;">78</span>   -<span style="color: #BB0000;">37</span>  -<span style="color: #BB0000;">64.5</span>   48.0  16.9  -<span style="color: #BB0000;">62.3</span>  46.9</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> F7             1   -<span style="color: #BB0000;">98</span>   -<span style="color: #BB0000;">31</span>  -<span style="color: #BB0000;">70.3</span>   42.5 -<span style="color: #BB0000;">11.4</span>  -<span style="color: #BB0000;">84</span>    50.5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> FT7            1   -<span style="color: #BB0000;">98</span>   -<span style="color: #BB0000;">10</span>  -<span style="color: #BB0000;">80.8</span>   14.1 -<span style="color: #BB0000;">11.1</span>  -<span style="color: #BB0000;">96.5</span>  17.0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> FC5            1   -<span style="color: #BB0000;">73</span>   -<span style="color: #BB0000;">14</span>  -<span style="color: #BB0000;">77.2</span>   18.6  24.5  -<span style="color: #BB0000;">70.8</span>  17.7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> FC3            1   -<span style="color: #BB0000;">49</span>   -<span style="color: #BB0000;">21</span>  -<span style="color: #BB0000;">60.2</span>   22.7  55.5  -<span style="color: #BB0000;">45.8</span>  17.6</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 60 more rows</span></span>
<span class="fu"><a href="../reference/topoplot.html">topoplot</a></span><span class="op">(</span><span class="va">epoched_example</span>,
         time_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.22</span>, <span class="fl">.24</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Creating epochs based on combinations of variables: participant_id epoch_labels</span>
<span class="co">#&gt; Using electrode locations from data.</span>
<span class="co">#&gt; Removing channels with no location.</span>
<span class="co">#&gt; Plotting head r 95 mm</span></code></pre></div>
<p><img src="eegUtils_files/figure-html/do-topo-1.png" width="700"></p>
<p>At any point, <code>eegUtils</code> objects can be transformed into
data frames for use with functions that don’t natively support them.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="va">epoched_example</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/select_epochs.html">select_epochs</a></span><span class="op">(</span>epoch_no <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/select_elecs.html">select_elecs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PO8"</span>, <span class="st">"Cz"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span>long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">amplitude</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">epoch</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun.y <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"line"</span>,
               size <span class="op">=</span> <span class="fl">2</span>,
               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">electrode</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">electrode</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Warning: `fun.y` is deprecated. Use `fun` instead.</span></code></pre></div>
<p><img src="eegUtils_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="tidyverse-functions">Tidyverse functions<a class="anchor" aria-label="anchor" href="#tidyverse-functions"></a>
</h2>
<p>In addition, there are overloaded versions of some <code>dplyr</code>
functions that operate on the <code>signals</code> element of
<code>eeg_data</code> and <code>eeg_epochs</code> objects. For example,
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code> can be used to choose particular electrodes, and
<code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> can be used to filter out epochs or timepoints.
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> can be used to add new columns (e.g. creating ROIs
from multiple electrodes).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epoched_example</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/rm_baseline.html">rm_baseline</a></span><span class="op">(</span>time_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>occipital <span class="op">=</span> <span class="op">(</span><span class="va">O1</span> <span class="op">+</span> <span class="va">O2</span> <span class="op">+</span> <span class="va">Oz</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Oz</span>, <span class="va">Fz</span>, <span class="va">occipital</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">epoch</span> <span class="op">&lt;=</span> <span class="fl">60</span>, <span class="va">time</span> <span class="op">&lt;</span> <span class="fl">.3</span>, <span class="va">time</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span>long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">amplitude</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">epoch</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"line"</span>,
               size <span class="op">=</span> <span class="fl">2</span>,
               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">electrode</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">electrode</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Baseline: -0.1 - 0s</span></code></pre></div>
<p><img src="eegUtils_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matt Craddock.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
