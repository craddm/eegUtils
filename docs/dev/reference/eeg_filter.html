<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Filter EEG data — eeg_filter • eegUtils</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Filter EEG data — eeg_filter" />
<meta property="og:description" content="Perform IIR or FIR filtering on input EEG data of class eeg_data or
eeg_epochs. WARNING: with epoched data, epoch boundaries are currently
ignored, which can result in minor edge artifacts." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eegUtils</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.6.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/eegUtils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/data_structures.html">A guide to eegUtils data structures</a>
    </li>
    <li>
      <a href="../articles/epoch-handling.html">Event and epoch handling</a>
    </li>
    <li>
      <a href="../articles/linear_modelling/linear_modelling.html">Linear Modelling</a>
    </li>
    <li>
      <a href="../articles/time-frequency-analysis.html">Frequency analysis</a>
    </li>
    <li>
      <a href="../articles/topoplot/topoplot.html">Building a topographical plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://www.twitter.com/matt_craddock">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/craddm/eegUtils/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter EEG data</h1>
    <small class="dont-index">Source: <a href='https://github.com/craddm/eegUtils/blob/master/R/filtering.R'><code>R/filtering.R</code></a></small>
    <div class="hidden name"><code>eeg_filter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform IIR or FIR filtering on input EEG data of class <code>eeg_data</code> or
<code>eeg_epochs</code>. WARNING: with epoched data, epoch boundaries are currently
ignored, which can result in minor edge artifacts.</p>
    </div>

    <pre class="usage"><span class='fu'>eeg_filter</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for eeg_data</span>
<span class='fu'>eeg_filter</span><span class='op'>(</span>
  <span class='va'>data</span>,
  low_freq <span class='op'>=</span> <span class='cn'>NULL</span>,
  high_freq <span class='op'>=</span> <span class='cn'>NULL</span>,
  filter_order <span class='op'>=</span> <span class='st'>"auto"</span>,
  trans_bw <span class='op'>=</span> <span class='st'>"auto"</span>,
  method <span class='op'>=</span> <span class='st'>"fir"</span>,
  window <span class='op'>=</span> <span class='st'>"hamming"</span>,
  demean <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for eeg_epochs</span>
<span class='fu'>eeg_filter</span><span class='op'>(</span>
  <span class='va'>data</span>,
  low_freq <span class='op'>=</span> <span class='cn'>NULL</span>,
  high_freq <span class='op'>=</span> <span class='cn'>NULL</span>,
  filter_order <span class='op'>=</span> <span class='st'>"auto"</span>,
  trans_bw <span class='op'>=</span> <span class='st'>"auto"</span>,
  method <span class='op'>=</span> <span class='st'>"fir"</span>,
  window <span class='op'>=</span> <span class='st'>"hamming"</span>,
  demean <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for eeg_group</span>
<span class='fu'>eeg_filter</span><span class='op'>(</span>
  <span class='va'>data</span>,
  low_freq <span class='op'>=</span> <span class='cn'>NULL</span>,
  high_freq <span class='op'>=</span> <span class='cn'>NULL</span>,
  filter_order <span class='op'>=</span> <span class='st'>"auto"</span>,
  trans_bw <span class='op'>=</span> <span class='st'>"auto"</span>,
  method <span class='op'>=</span> <span class='st'>"fir"</span>,
  window <span class='op'>=</span> <span class='st'>"hamming"</span>,
  demean <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>An <code>eeg_data</code> or <code>eeg_epochs</code> object to be filtered.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters.</p></td>
    </tr>
    <tr>
      <th>low_freq</th>
      <td><p>Low cutoff frequency.</p></td>
    </tr>
    <tr>
      <th>high_freq</th>
      <td><p>High cutoff frequency.</p></td>
    </tr>
    <tr>
      <th>filter_order</th>
      <td><p>Defaults to "auto", which automatically estimates filter order for the specified filter characteristics (defaults to 4 if method = "iir").</p></td>
    </tr>
    <tr>
      <th>trans_bw</th>
      <td><p>Transition bandwidth of the filter. "auto" or an integer.
"auto" attempts to determine a suitable transition bandwidth using the
heuristic given below. Ignored if method = "iir".</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>"fir" (Finite Impulse Response) or "iir" (Infinite Impulse
Response). Defaults to "fir".</p></td>
    </tr>
    <tr>
      <th>window</th>
      <td><p>Windowing function to use (FIR filtering only). Defaults to
"hamming"; currently only "hamming" available.</p></td>
    </tr>
    <tr>
      <th>demean</th>
      <td><p>Remove DC component (i.e. channel/epoch mean) before filtering. Defaults to TRUE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of the original class with signals filtered according to
the user's specifications</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>low_freq and high_freq are the low and high cutoff frequencies. Pass low freq
or high freq alone to perform high-pass or low-pass filtering respectively.
For band-pass or band-stop filters, pass both low_freq and high_freq.</p>
<p>If low_freq &lt; high_freq, bandpass filtering is performed.</p>
<p>If low_freq &gt; high_freq, bandstop filtering is performed.</p>
<p>Note that it is recommended to first zero-mean the signal using either
channel means or by-channel epoch means.</p>
<p>The function allows parallelization using the <code>future</code> package, e.g. using
<code>plan(multiprocess)</code></p>
    <h2 class="hasAnchor" id="fir-versus-iir-filtering"><a class="anchor" href="#fir-versus-iir-filtering"></a>FIR versus IIR filtering</h2>

    <p>Finite Impulse Response (FIR) filtering is
performed using an overlap-add FFT method. Note that this only performs a
single-pass; the data is shifted back in time by the group delay of the
filter to compensate for the phase delay imposed by the linear filtering
process. Infinite Impulse Response (IIR) filtering is performed using a
two-pass (once forwards, once reversed) method to correct for phase
alignment. Note that the Butterworth filter designs used here can become
numerically unstable with only a small increase in filter order. For most
purposes, use FIR filters.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='plot_psd.html'>plot_psd</a></span><span class='op'>(</span><span class='fu'>eeg_filter</span><span class='op'>(</span><span class='va'>demo_epochs</span>, low_freq <span class='op'>=</span> <span class='fl'>1</span>, high_freq <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Band-pass FIR filter from 1 - 30 Hz</span></div><div class='output co'>#&gt; <span class='message'>Transition bandwidth: 1 Hz</span></div><div class='output co'>#&gt; <span class='message'>Filter order: 424</span></div><div class='output co'>#&gt; <span class='message'>Removing channel means per epoch...</span></div><div class='output co'>#&gt; <span class='message'>Removing channel means per epoch...</span></div><div class='output co'>#&gt; <span class='message'>Computing Power Spectral Density using Welch's method.</span>
#&gt; <span class='message'>FFT length: 256</span>
#&gt; <span class='message'>Segment length: 84</span>
#&gt; <span class='message'>Overlapping points: 42 (50% overlap)</span></div><div class='img'><img src='eeg_filter-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='plot_psd.html'>plot_psd</a></span><span class='op'>(</span><span class='fu'>eeg_filter</span><span class='op'>(</span><span class='va'>demo_epochs</span>, low_freq <span class='op'>=</span> <span class='fl'>12</span>, high_freq <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Band-stop FIR filter from 8 - 12 Hz.</span></div><div class='output co'>#&gt; <span class='message'>Transition bandwidth: 2 Hz</span></div><div class='output co'>#&gt; <span class='message'>Filter order: 212</span></div><div class='output co'>#&gt; <span class='message'>Removing channel means per epoch...</span></div><div class='output co'>#&gt; <span class='message'>Removing channel means per epoch...</span></div><div class='output co'>#&gt; <span class='message'>Computing Power Spectral Density using Welch's method.</span>
#&gt; <span class='message'>FFT length: 256</span>
#&gt; <span class='message'>Segment length: 84</span>
#&gt; <span class='message'>Overlapping points: 42 (50% overlap)</span></div><div class='img'><img src='eeg_filter-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='plot_psd.html'>plot_psd</a></span><span class='op'>(</span><span class='fu'>eeg_filter</span><span class='op'>(</span><span class='va'>demo_epochs</span>, low_freq <span class='op'>=</span> <span class='fl'>12</span>, high_freq <span class='op'>=</span> <span class='fl'>8</span>, method <span class='op'>=</span> <span class='st'>"iir"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Band-stop IIR filter from 8 - 12 Hz.</span></div><div class='output co'>#&gt; <span class='message'>Effective filter order: 4 (two-pass)</span></div><div class='output co'>#&gt; <span class='message'>Removing channel means per epoch...</span></div><div class='output co'>#&gt; <span class='message'>Removing channel means per epoch...</span></div><div class='output co'>#&gt; <span class='message'>Computing Power Spectral Density using Welch's method.</span>
#&gt; <span class='message'>FFT length: 256</span>
#&gt; <span class='message'>Segment length: 84</span>
#&gt; <span class='message'>Overlapping points: 42 (50% overlap)</span></div><div class='img'><img src='eeg_filter-3.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matt Craddock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


