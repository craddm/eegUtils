<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A collection of utilities for EEG analysis  • eegUtils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="A collection of utilities for EEG analysis ">
<meta property="og:description" content="A collection of functions for EEG processing. Includes import
  functions for Biosemi (BDF) and Neuroscan (CNT), topographical plotting, referencing, and epoching.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">eegUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/eegUtils.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/data_structures.html">A guide to eegUtils data structures</a>
    </li>
    <li>
      <a href="articles/epoch-handling.html">Event and epoch handling</a>
    </li>
    <li>
      <a href="articles/time-frequency-analysis.html">Frequency analysis</a>
    </li>
    <li>
      <a href="articles/topoplot.html">Building a topographical plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/craddm/eegUtils">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="eegutils" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#eegutils" class="anchor"></a>eegUtils</h1></div>

<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p><em>eegUtils</em> is a package for the processing, manipulation, and plotting of EEG data. It includes functions for importing data from a variety of file formats (including Biosemi, Brain Vision Analyzer, and EEGLAB), many of the typical steps in pre-preprocessing (filtering, referencing, artefact rejection), more advanced processing techniques (time-frequency analysis, ICA), and many types of plot that are common in the field (ERP plots, time-frequency plots, topographical scalp maps). Although it uses custom object classes, it is designed such that these are always translatable to standard R <em>data.frames</em>, and thus can be used with any of the myriad packages and methods that support standard R formats.</p>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>The package is very much under active development and is subject to a lot of changes. As such, it is not currently available on CRAN. Install the latest released version from Github as below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#install.packages("remotes")</span></a>
<a class="sourceLine" id="cb1-2" title="2">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"craddm/eegUtils"</span>)</a></code></pre></div>
<p>To install the latest development version, install from the <em>develop</em> branch as below.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"craddm/eegUtils@develop"</span>)</a></code></pre></div>
</div>
<div id="usage" class="section level3">
<h3 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h3>
<p>In this simple example, we load a Biosemi .BDF file. This data is from an experiment in which participants were cued with a word and then shown a picture of an object that was either a semantic match or a semantic mismatch for the word.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(eegUtils)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; Make sure to check for the latest development version at https://github.com/craddm/eegUtils!</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; Attaching package: 'eegUtils'</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; The following object is masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt;     filter</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb3-18" title="18">eeg_example &lt;-<span class="st"> </span><span class="kw"><a href="reference/import_raw.html">import_raw</a></span>(<span class="st">"F:</span><span class="ch">\\</span><span class="st">Dropbox</span><span class="ch">\\</span><span class="st">EEGData</span><span class="ch">\\</span><span class="st">RawEEGData</span><span class="ch">\\</span><span class="st">BasicCat</span><span class="ch">\\</span><span class="st">S2B1.bdf"</span>)</a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt; Importing F:\Dropbox\EEGData\RawEEGData\BasicCat\S2B1.bdf as BDF</span></a>
<a class="sourceLine" id="cb3-20" title="20">eeg_example</a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt; EEG data</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt; Number of channels   : 72 </span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">#&gt; Electrode names      : A1 A2 A3 A4 A5 A6 A7 A8 A9 A10 A11 A12 A13 A14 A15 A16 A17 A18 A19 A20 A21 A22 A23 A24 A25 A26 A27 A28 A29 A30 A31 A32 B1 B2 B3 B4 B5 B6 B7 B8 B9 B10 B11 B12 B13 B14 B15 B16 B17 B18 B19 B20 B21 B22 B23 B24 B25 B26 B27 B28 B29 B30 B31 B32 EXG1 EXG2 EXG3 EXG4 EXG5 EXG6 EXG7 EXG8 </span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">#&gt; Sampling rate        : 512 Hz</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">#&gt; Reference        :</span></a></code></pre></div>
<p>This data was recorded at 512 Hz. There were 72 channels named using the BioSemi alpha-numeric format. EXG1-EXG4 were electrodes placed around the eyes to record eye movements. EXG5 and EXG6 were reference electrodes placed on the participant’s earlobes. EXG7 and EXG8 are empty channels; no electrodes were attached.</p>
<p>We can use the <em>select_elecs()</em> function to select specific channels to keep or remove. Here we’ll remove the empty channels EXG7 and EXG8.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">eeg_example <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw"><a href="reference/select_elecs.html">select_elecs</a></span>(<span class="dt">electrode =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"EXG7"</span>, <span class="st">"EXG8"</span>),</a>
<a class="sourceLine" id="cb4-3" title="3">               <span class="dt">keep =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; EEG data</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; Number of channels   : 70 </span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; Electrode names      : A1 A2 A3 A4 A5 A6 A7 A8 A9 A10 A11 A12 A13 A14 A15 A16 A17 A18 A19 A20 A21 A22 A23 A24 A25 A26 A27 A28 A29 A30 A31 A32 B1 B2 B3 B4 B5 B6 B7 B8 B9 B10 B11 B12 B13 B14 B15 B16 B17 B18 B19 B20 B21 B22 B23 B24 B25 B26 B27 B28 B29 B30 B31 B32 EXG1 EXG2 EXG3 EXG4 EXG5 EXG6 </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; Sampling rate        : 512 Hz</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; Reference        :</span></a></code></pre></div>
<p>Note that we could also use the <em>select()</em> function from the <em>dplyr</em> package, as <em>eegUtils</em> has wrapper functions around several <em>dplyr</em> functions. Here we’ll use it in a chain of pipes leading to the <em>eeg_reference()</em> function, which references or rereferences our EEG data. It defaults to average reference.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">eeg_example &lt;-<span class="st"> </span>eeg_example <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>EXG7, <span class="op">-</span>EXG8) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  </span><span class="kw"><a href="reference/eeg_reference.html">eeg_reference</a></span>()</a>
<a class="sourceLine" id="cb5-4" title="4">eeg_example</a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt; EEG data</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt; Number of channels   : 70 </span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; Electrode names      : A1 A2 A3 A4 A5 A6 A7 A8 A9 A10 A11 A12 A13 A14 A15 A16 A17 A18 A19 A20 A21 A22 A23 A24 A25 A26 A27 A28 A29 A30 A31 A32 B1 B2 B3 B4 B5 B6 B7 B8 B9 B10 B11 B12 B13 B14 B15 B16 B17 B18 B19 B20 B21 B22 B23 B24 B25 B26 B27 B28 B29 B30 B31 B32 EXG1 EXG2 EXG3 EXG4 EXG5 EXG6 </span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; Sampling rate        : 512 Hz</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; Reference        : average</span></a></code></pre></div>
<p>A typical step at this stage is to filter the continuous data before epoching. We’ll quickly inspect the power spectral density, calculated using Welch’s method, of our data using <em>plot_psd()</em>. We then perform a bandpass filter from .1 Hz to 40 Hz using FIR filtering, using <em>eeg_filter()</em>. Note that this function can be made to use multiple cores or processes through the <em>future</em> package.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(future)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">plan</span>(multiprocess)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw"><a href="reference/plot_psd.html">plot_psd</a></span>(eeg_example, </a>
<a class="sourceLine" id="cb6-4" title="4">         <span class="dt">freq_range =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">60</span>),</a>
<a class="sourceLine" id="cb6-5" title="5">         <span class="dt">legend =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; Removing channel means...</span></a></code></pre></div>
<p><img src="reference/figures/do_filt-1.png"><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">eeg_example &lt;-<span class="st"> </span><span class="kw"><a href="reference/eeg_filter.html">eeg_filter</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb7-2" title="2">                          <span class="dt">low_freq =</span> <span class="fl">.1</span>,</a>
<a class="sourceLine" id="cb7-3" title="3">                          <span class="dt">high_freq =</span> <span class="dv">40</span>,</a>
<a class="sourceLine" id="cb7-4" title="4">                          <span class="dt">method =</span> <span class="st">"fir"</span>)</a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; Band-pass FIR filter from 0.1 - 40 Hz</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; Transition bandwidth: 0.1 Hz</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; Filter order: 16896</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; Removing channel means...</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="kw"><a href="reference/plot_psd.html">plot_psd</a></span>(eeg_example, </a>
<a class="sourceLine" id="cb7-10" title="10">         <span class="dt">freq_range =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">60</span>),</a>
<a class="sourceLine" id="cb7-11" title="11">         <span class="dt">legend =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; Removing channel means...</span></a></code></pre></div>
<p><img src="reference/figures/do_filt-2.png"><!-- --></p>
<p>The next step is to epoch our filtered data. The trigger <em>201</em> marks stimulus onset.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">example_epochs &lt;-<span class="st"> </span><span class="kw"><a href="reference/epoch_data.html">epoch_data</a></span>(eeg_example,</a>
<a class="sourceLine" id="cb8-2" title="2">                             <span class="dt">events =</span> <span class="dv">201</span>)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; Output limits:  -1 1</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; Removing channel means per epoch...</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; Creating 78 epochs.</span></a>
<a class="sourceLine" id="cb8-6" title="6">example_epochs</a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; Epoched EEG data</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; Number of channels   : 70 </span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; Number of epochs     : 78 </span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; Epoch limits     : -1 - 0.998 seconds</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt; Electrode names      : A1 A2 A3 A4 A5 A6 A7 A8 A9 A10 A11 A12 A13 A14 A15 A16 A17 A18 A19 A20 A21 A22 A23 A24 A25 A26 A27 A28 A29 A30 A31 A32 B1 B2 B3 B4 B5 B6 B7 B8 B9 B10 B11 B12 B13 B14 B15 B16 B17 B18 B19 B20 B21 B22 B23 B24 B25 B26 B27 B28 B29 B30 B31 B32 EXG1 EXG2 EXG3 EXG4 EXG5 EXG6 </span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt; Sampling rate        : 512  Hz</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt; Reference        : average</span></a></code></pre></div>
<p>We can plot ERPs of all the channels using <em>plot_butterfly()</em>. This can be quite slow at high sampling rates, with many electrodes, and long epochs. Here we’ll specify that we want the plot to be from .1s before to .5s after stimulus onset.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="reference/plot_butterfly.html">plot_butterfly</a></span>(example_epochs,</a>
<a class="sourceLine" id="cb9-2" title="2">               <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>, <span class="fl">.5</span>))</a></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-5-1.png"><!-- --> This outputs a <em>ggplot</em> object with some default styling already set.</p>
<p>Now we might want a topographical plot. But BioSemi data files do not include channel locations, so we need to add them ourselves.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">example_epochs &lt;-<span class="st"> </span><span class="kw"><a href="reference/electrode_locations.html">electrode_locations</a></span>(example_epochs,</a>
<a class="sourceLine" id="cb10-2" title="2">                                      <span class="dt">montage =</span> <span class="st">"biosemi64alpha"</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; Electrodes not found: EXG1 EXG2 EXG3 EXG4 EXG5 EXG6</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw"><a href="reference/channels.html">channels</a></span>(example_epochs)</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt; # A tibble: 70 x 9</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt;    electrode radius theta   phi cart_x cart_y cart_z     x     y</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt;  1 A1             1   -92   -72  -26.2   80.8  -2.97 -28.4  87.5</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt;  2 A2             1   -92   -54  -49.9   68.7  -2.97 -54.1  74.4</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt;  3 A3             1   -74   -65  -34.5   74.0  23.4  -31.3  67.1</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt;  4 A4             1   -50   -68  -24.4   60.4  54.6  -18.7  46.4</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt;  5 A5             1   -60   -51  -46.3   57.2  42.5  -37.8  46.6</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt;  6 A6             1   -75   -41  -62.0   53.9  22    -56.6  49.2</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt;  7 A7             1   -92   -36  -68.7   49.9  -2.97 -74.4  54.1</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">#&gt;  8 A8             1   -92   -18  -80.8   26.2  -2.97 -87.5  28.4</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">#&gt;  9 A9             1   -72   -21  -75.5   29.0  26.3  -67.2  25.8</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">#&gt; 10 A10            1   -50   -28  -57.5   30.6  54.6  -44.2  23.5</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="co">#&gt; # ... with 60 more rows</span></a></code></pre></div>
<p>Now we can create a topopgraphical plot, again with default stylings and colour schemes.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="reference/topoplot.html">topoplot</a></span>(example_epochs, <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">25</span>, <span class="fl">.35</span>))</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">#&gt; Using electrode locations from data.</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#&gt; Warning in topoplot.data.frame(data, time_lim = time_lim, limits =</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt; limits, : Removing channels with no location.</span></a></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-7-1.png"><!-- --></p>
<p>Since this is a <em>ggplot</em>, styling can be changed easily. For example, we could use a different colour scale, such as <em>viridis</em>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="reference/topoplot.html">topoplot</a></span>(example_epochs,</a>
<a class="sourceLine" id="cb12-2" title="2">         <span class="dt">time_lim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">25</span>, <span class="fl">.35</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>()</a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">#&gt; Using electrode locations from data.</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">#&gt; Warning in topoplot.data.frame(data, time_lim = time_lim, limits =</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">#&gt; limits, : Removing channels with no location.</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill',</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">#&gt; which will replace the existing scale.</span></a></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-8-1.png"><!-- --></p>
<p>At any point, <code>eegUtils</code> objects can be transformed into data frames for use with functions that don’t natively support them.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">example_epochs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">  </span><span class="kw"><a href="reference/select_epochs.html">select_epochs</a></span>(<span class="dt">epoch_no =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw"><a href="reference/select_elecs.html">select_elecs</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A29"</span>, <span class="st">"B6"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">  </span><span class="kw"><a href="reference/select_times.html">select_times</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>, <span class="fl">.4</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">  </span><span class="kw"><a href="reference/rm_baseline.html">rm_baseline</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span>.<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="dt">long =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> amplitude)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> epoch), <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,</a>
<a class="sourceLine" id="cb13-10" title="10">               <span class="dt">geom =</span> <span class="st">"line"</span>,</a>
<a class="sourceLine" id="cb13-11" title="11">               <span class="dt">size =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb13-12" title="12">               <span class="kw">aes</span>(<span class="dt">colour =</span> electrode)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>electrode) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="st">  </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-9-1.png"><!-- --></p>
<p>In addition, there are overloaded versions of some <code>dplyr</code> functions that operate on the <code>signals</code> element of <code>eeg_data</code> and <code>eeg_epochs</code> objects. For example, <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> can be used to choose particular electrodes, and <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> can be used to filter out epochs or timepoints. <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> can be used to add new columns (e.g. creating ROIs from multiple electrodes). Note that the objects can also be passed directly to <em>ggplot()</em>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">example_epochs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">occipital =</span> (A29 <span class="op">+</span><span class="st"> </span>A27 <span class="op">+</span><span class="st"> </span>B32) <span class="op">/</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(A29, B6, occipital) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(epoch <span class="op">&lt;=</span><span class="st"> </span><span class="dv">60</span>, time <span class="op">&gt;</span><span class="st"> </span><span class="fl">-.1</span>, time <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> amplitude)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> epoch), <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,</a>
<a class="sourceLine" id="cb14-8" title="8">               <span class="dt">geom =</span> <span class="st">"line"</span>,</a>
<a class="sourceLine" id="cb14-9" title="9">               <span class="dt">size =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb14-10" title="10">               <span class="kw">aes</span>(<span class="dt">colour =</span> electrode)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>electrode) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-12" title="12"><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="st">  </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-10-1.png"><!-- --></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/craddm/eegUtils">https://​github.com/​craddm/​eegUtils</a>
</li>
<li>Report a bug at <br><a href="https://github.com/craddm/eegUtils/issues">https://​github.com/​craddm/​eegUtils/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Matt Craddock <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="http://www.repostatus.org/#wip"><img src="http://www.repostatus.org/badges/latest/wip.svg" alt="Repo Status"></a></li>
<li><a href="https://codecov.io/github/craddm/eegUtils?branch=master"><img src="https://img.shields.io/codecov/c/github/craddm/eegUtils/master.svg" alt="Coverage Status"></a></li>
<li><a href="https://travis-ci.org/craddm/eegUtils"><img src="https://travis-ci.org/craddm/eegUtils.svg?branch=master" alt="Travis Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/craddm/eegUtils"><img src="https://ci.appveyor.com/api/projects/status/github/craddm/eegUtils?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/85406871"><img src="https://zenodo.org/badge/85406871.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Matt Craddock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
