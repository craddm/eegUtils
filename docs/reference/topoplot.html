<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Topographical Plotting Function for EEG — topoplot • eegUtils</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Topographical Plotting Function for EEG — topoplot" />
<meta property="og:description" content="Allows topographical plotting of functional data. Output is a ggplot2 object." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eegUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/eegUtils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/data_structures.html">A guide to eegUtils data structures</a>
    </li>
    <li>
      <a href="../articles/epoch-handling.html">Event and epoch handling</a>
    </li>
    <li>
      <a href="../articles/time-frequency-analysis.html">Frequency analysis</a>
    </li>
    <li>
      <a href="../articles/topoplot.html">Building a topographical plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/craddm/eegUtils">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Topographical Plotting Function for EEG</h1>
    <small class="dont-index">Source: <a href='https://github.com/craddm/eegUtils/blob/master/R/topoplot.R'><code>R/topoplot.R</code></a></small>
    <div class="hidden name"><code>topoplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Allows topographical plotting of functional data. Output is a ggplot2 object.</p>
    </div>

    <pre class="usage"><span class='fu'>topoplot</span>(<span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>topoplot</span>(<span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S3 method for data.frame</span>
<span class='fu'>topoplot</span>(<span class='no'>data</span>, <span class='kw'>time_lim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>limits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>chanLocs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"Biharmonic"</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>grid_res</span> <span class='kw'>=</span> <span class='fl'>200</span>,
  <span class='kw'>palette</span> <span class='kw'>=</span> <span class='st'>"RdBu"</span>, <span class='kw'>interp_limit</span> <span class='kw'>=</span> <span class='st'>"skirt"</span>, <span class='kw'>contour</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>chan_marker</span> <span class='kw'>=</span> <span class='st'>"point"</span>, <span class='kw'>quantity</span> <span class='kw'>=</span> <span class='st'>"amplitude"</span>, <span class='kw'>montage</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>colourmap</span>, <span class='kw'>highlights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>scaling</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for eeg_data</span>
<span class='fu'>topoplot</span>(<span class='no'>data</span>, <span class='kw'>time_lim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>limits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>chanLocs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"Biharmonic"</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>grid_res</span> <span class='kw'>=</span> <span class='fl'>200</span>,
  <span class='kw'>palette</span> <span class='kw'>=</span> <span class='st'>"RdBu"</span>, <span class='kw'>interp_limit</span> <span class='kw'>=</span> <span class='st'>"skirt"</span>, <span class='kw'>contour</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>chan_marker</span> <span class='kw'>=</span> <span class='st'>"point"</span>, <span class='kw'>quantity</span> <span class='kw'>=</span> <span class='st'>"amplitude"</span>, <span class='kw'>montage</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>highlights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>scaling</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for eeg_epochs</span>
<span class='fu'>topoplot</span>(<span class='no'>data</span>, <span class='kw'>time_lim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>limits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>chanLocs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"Biharmonic"</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>grid_res</span> <span class='kw'>=</span> <span class='fl'>200</span>,
  <span class='kw'>palette</span> <span class='kw'>=</span> <span class='st'>"RdBu"</span>, <span class='kw'>interp_limit</span> <span class='kw'>=</span> <span class='st'>"skirt"</span>, <span class='kw'>contour</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>chan_marker</span> <span class='kw'>=</span> <span class='st'>"point"</span>, <span class='kw'>quantity</span> <span class='kw'>=</span> <span class='st'>"amplitude"</span>, <span class='kw'>montage</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>highlights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>scaling</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>)

<span class='co'># S3 method for eeg_ICA</span>
<span class='fu'>topoplot</span>(<span class='no'>data</span>, <span class='no'>component</span>, <span class='kw'>time_lim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>limits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>chanLocs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"Biharmonic"</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>grid_res</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>palette</span> <span class='kw'>=</span> <span class='st'>"RdBu"</span>, <span class='kw'>interp_limit</span> <span class='kw'>=</span> <span class='st'>"skirt"</span>,
  <span class='kw'>contour</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>chan_marker</span> <span class='kw'>=</span> <span class='st'>"point"</span>, <span class='kw'>quantity</span> <span class='kw'>=</span> <span class='st'>"amplitude"</span>,
  <span class='kw'>montage</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>colourmap</span>, <span class='kw'>highlights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>scaling</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for eeg_tfr</span>
<span class='fu'>topoplot</span>(<span class='no'>data</span>, <span class='kw'>time_lim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>limits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>chanLocs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"Biharmonic"</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>grid_res</span> <span class='kw'>=</span> <span class='fl'>200</span>,
  <span class='kw'>palette</span> <span class='kw'>=</span> <span class='st'>"RdBu"</span>, <span class='kw'>interp_limit</span> <span class='kw'>=</span> <span class='st'>"skirt"</span>, <span class='kw'>contour</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>chan_marker</span> <span class='kw'>=</span> <span class='st'>"point"</span>, <span class='kw'>quantity</span> <span class='kw'>=</span> <span class='st'>"power"</span>, <span class='kw'>montage</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>highlights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>scaling</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>freq_range</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>An EEG dataset. If the input is a data.frame, then it must have
columns x, y, and amplitude at present. x and y are (Cartesian) electrode
co-ordinates), amplitude is amplitude.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Various arguments passed to specific functions</p></td>
    </tr>
    <tr>
      <th>time_lim</th>
      <td><p>Timepoint(s) to plot. Can be one time or a range to average
over. If none is supplied, the function will average across all timepoints
in the supplied data.</p></td>
    </tr>
    <tr>
      <th>limits</th>
      <td><p>Limits of the fill scale - should be given as a character
vector with two values specifying the start and endpoints e.g. limits =
c(-2,-2). Will ignore anything else. Defaults to the range of the data.</p></td>
    </tr>
    <tr>
      <th>chanLocs</th>
      <td><p>Allows passing of channel locations (see
<code>electrode_locations</code>)</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Interpolation method. "Biharmonic" or "gam". "Biharmonic"
implements the same method used in Matlab's EEGLAB. "gam" fits a
Generalized Additive Model with k = 40 knots. Defaults to biharmonic spline
interpolation.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>Radius of cartoon head_shape; if not given, defaults to 1.1 * the
maximum y electrode location.</p></td>
    </tr>
    <tr>
      <th>grid_res</th>
      <td><p>Resolution of the interpolated grid. Higher = smoother but
slower.</p></td>
    </tr>
    <tr>
      <th>palette</th>
      <td><p>Defaults to RdBu if none supplied. Can be any from
RColorBrewer or viridis. If an unsupported palette is specified, switches
to Greens.</p></td>
    </tr>
    <tr>
      <th>interp_limit</th>
      <td><p>"skirt" or "head". Defaults to "skirt". "skirt"
interpolates just past the farthest electrode and does not respect the
boundary of the head_shape. "head" interpolates up to the radius of the
plotted head.</p></td>
    </tr>
    <tr>
      <th>contour</th>
      <td><p>Plot contour lines on topography (defaults to TRUE)</p></td>
    </tr>
    <tr>
      <th>chan_marker</th>
      <td><p>Set marker for electrode locations. "point" = point,
"name" = electrode name, "none" = no marker. Defaults to "point".</p></td>
    </tr>
    <tr>
      <th>quantity</th>
      <td><p>Allows plotting of arbitrary quantitative column. Defaults to
amplitude. Use quoted column names. E.g. "p.value", "t_statistic".</p></td>
    </tr>
    <tr>
      <th>montage</th>
      <td><p>Name of an existing montage set. Defaults to NULL; (currently
only 'biosemi64alpha' available other than default 10/20 system)</p></td>
    </tr>
    <tr>
      <th>colourmap</th>
      <td><p>Deprecated, use palette instead.</p></td>
    </tr>
    <tr>
      <th>highlights</th>
      <td><p>Electrodes to highlight (in white).</p></td>
    </tr>
    <tr>
      <th>scaling</th>
      <td><p>Scaling multiplication factor for labels and any plot lines.
Defaults to 1.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>Column name for groups to retain.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Warning messages when electrodes do not have locations.
Defaults to TRUE.</p></td>
    </tr>
    <tr>
      <th>component</th>
      <td><p>Component to plot (numeric)</p></td>
    </tr>
    <tr>
      <th>freq_range</th>
      <td><p>Range of frequencies to average over.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="methods-by-class-"><a class="anchor" href="#methods-by-class-"></a>Methods (by class)</h2>

    
<ul>
<li><p><code>default</code>: Default method for data frames.</p></li>
<li><p><code>data.frame</code>: Topographical plotting of data.frames and other non
eeg_data objects.</p></li>
<li><p><code>eeg_data</code>: Topographical plotting of <code>eeg_data</code> objects.</p></li>
<li><p><code>eeg_epochs</code>: Topographical plotting of <code>eeg_epochs</code> objects.</p></li>
<li><p><code>eeg_ICA</code>: Topographical plot for <code>eeg_ICA</code> objects</p></li>
<li><p><code>eeg_tfr</code>: Topographical plotting of <code>eeg_tfr</code> objects.</p></li>
</ul>
    <h2 class="hasAnchor" id="notes-on-usage-of-generalized-additive-models-for-interpolation"><a class="anchor" href="#notes-on-usage-of-generalized-additive-models-for-interpolation"></a>Notes on usage of Generalized Additive Models for interpolation</h2>

    <p>The
  function fits a GAM using the gam function from mgcv. Specifically, it fits
  a spline using the model function gam(z ~ s(x, y, bs = "ts", k = 40). Using
  GAMs for smooths is very much experimental. The surface is produced from
  the predictions of the GAM model fitted to the supplied data. Values at
  each electrode do not necessarily match actual values in the data:
  high-frequency variation will tend to be smoothed out. Thus, the method
  should be used with caution.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>topoplot</span>(<span class='no'>demo_epochs</span>)</div><div class='output co'>#&gt; <span class='message'>Using electrode locations from data.</span></div><div class='img'><img src='topoplot-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>topoplot</span>(<span class='no'>demo_epochs</span>, <span class='kw'>time_lim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.1</span>, <span class='fl'>.2</span>))</div><div class='output co'>#&gt; <span class='message'>Using electrode locations from data.</span></div><div class='img'><img src='topoplot-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#methods-by-class-">Methods (by class)</a></li>
      <li><a href="#notes-on-usage-of-generalized-additive-models-for-interpolation">Notes on usage of Generalized Additive Models for interpolation</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Matt Craddock, <a href='mailto:matt@mattcraddock.com'>matt@mattcraddock.com</a></p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matt Craddock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


