<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Filter EEG data — eeg_filter • eegUtils</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter EEG data — eeg_filter"><meta name="description" content="Perform IIR or FIR filtering on input EEG data of class eeg_data or
eeg_epochs. WARNING: with epoched data, epoch boundaries are currently
ignored, which can result in minor edge artifacts."><meta property="og:description" content="Perform IIR or FIR filtering on input EEG data of class eeg_data or
eeg_epochs. WARNING: with epoched data, epoch boundaries are currently
ignored, which can result in minor edge artifacts."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eegUtils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/eegUtils.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/data_structures.html">A guide to eegUtils data structures</a></li>
    <li><a class="dropdown-item" href="../articles/epoch-handling.html">Event and epoch handling</a></li>
    <li><a class="dropdown-item" href="../articles/linear_modelling/linear_modelling.html">Linear Modelling</a></li>
    <li><a class="dropdown-item" href="../articles/time-frequency-analysis.html">Frequency analysis</a></li>
    <li><a class="dropdown-item" href="../articles/topoplot/topoplot.html">Building a topographical plot</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/craddm/eegUtils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Filter EEG data</h1>
      <small class="dont-index">Source: <a href="https://github.com/craddm/eegUtils/blob/main/R/filtering.R" class="external-link"><code>R/filtering.R</code></a></small>
      <div class="d-none name"><code>eeg_filter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform IIR or FIR filtering on input EEG data of class <code>eeg_data</code> or
<code>eeg_epochs</code>. WARNING: with epoched data, epoch boundaries are currently
ignored, which can result in minor edge artifacts.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eeg_filter</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'eeg_data'</span></span>
<span><span class="fu">eeg_filter</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  low_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  high_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter_order <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  trans_bw <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"fir"</span>,</span>
<span>  window <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  demean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'eeg_epochs'</span></span>
<span><span class="fu">eeg_filter</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  low_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  high_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter_order <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  trans_bw <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"fir"</span>,</span>
<span>  window <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  demean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'eeg_group'</span></span>
<span><span class="fu">eeg_filter</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  low_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  high_freq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter_order <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  trans_bw <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"fir"</span>,</span>
<span>  window <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  demean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>An <code>eeg_data</code> or <code>eeg_epochs</code> object to be filtered.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters.</p></dd>


<dt id="arg-low-freq">low_freq<a class="anchor" aria-label="anchor" href="#arg-low-freq"></a></dt>
<dd><p>Low cutoff frequency.</p></dd>


<dt id="arg-high-freq">high_freq<a class="anchor" aria-label="anchor" href="#arg-high-freq"></a></dt>
<dd><p>High cutoff frequency.</p></dd>


<dt id="arg-filter-order">filter_order<a class="anchor" aria-label="anchor" href="#arg-filter-order"></a></dt>
<dd><p>Defaults to "auto", which automatically estimates filter
order for the specified filter characteristics (defaults to 4 if method =
"iir").</p></dd>


<dt id="arg-trans-bw">trans_bw<a class="anchor" aria-label="anchor" href="#arg-trans-bw"></a></dt>
<dd><p>Transition bandwidth of the filter. "auto" or an integer.
"auto" attempts to determine a suitable transition bandwidth using the
heuristic given below. Ignored if method = "iir".</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>"fir" (Finite Impulse Response) or "iir" (Infinite Impulse
Response). Defaults to "fir".</p></dd>


<dt id="arg-window">window<a class="anchor" aria-label="anchor" href="#arg-window"></a></dt>
<dd><p>Windowing function to use (FIR filtering only). Defaults to
"hamming"; currently only "hamming" available.</p></dd>


<dt id="arg-demean">demean<a class="anchor" aria-label="anchor" href="#arg-demean"></a></dt>
<dd><p>Remove DC component (i.e. channel/epoch mean) before filtering.
Defaults to TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of the original class with signals filtered according to
the user's specifications</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>low_freq and high_freq are the low and high cutoff frequencies. Pass low freq
or high freq alone to perform high-pass or low-pass filtering respectively.
For band-pass or band-stop filters, pass both low_freq and high_freq.</p>
<p>If low_freq &lt; high_freq, bandpass filtering is performed.</p>
<p>If low_freq &gt; high_freq, bandstop filtering is performed.</p>
<p>Note that it is recommended to first zero-mean the signal using either
channel means or by-channel epoch means.</p>
<p>The function allows parallelization using the <code>future</code> package, e.g. using
<code>plan(multisession)</code></p>
    </div>
    <div class="section level2">
    <h2 id="fir-versus-iir-filtering">FIR versus IIR filtering<a class="anchor" aria-label="anchor" href="#fir-versus-iir-filtering"></a></h2>
    <p>Finite Impulse Response (FIR) filtering is
performed using an overlap-add FFT method. Note that this only performs a
single-pass; the data is shifted back in time by the group delay of the
filter to compensate for the phase delay imposed by the linear filtering
process. Infinite Impulse Response (IIR) filtering is performed using a
two-pass (once forwards, once reversed) method to correct for phase
alignment. Note that the Butterworth filter designs used here can become
numerically unstable with only a small increase in filter order. For most
purposes, use FIR filters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="plot_psd.html">plot_psd</a></span><span class="op">(</span><span class="fu">eeg_filter</span><span class="op">(</span><span class="va">demo_epochs</span>, low_freq <span class="op">=</span> <span class="fl">1</span>, high_freq <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Band-pass FIR filter from 1 - 30 Hz</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Transition bandwidth: 1 Hz</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filter order: 424</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Power Spectral Density using Welch's method.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> FFT length: 256</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Segment length: 84</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points: 42 (50% overlap)</span>
<span class="r-plt img"><img src="eeg_filter-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="plot_psd.html">plot_psd</a></span><span class="op">(</span><span class="fu">eeg_filter</span><span class="op">(</span><span class="va">demo_epochs</span>, low_freq <span class="op">=</span> <span class="fl">12</span>, high_freq <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Band-stop FIR filter from 8 - 12 Hz.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Transition bandwidth: 2 Hz</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filter order: 212</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Power Spectral Density using Welch's method.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> FFT length: 256</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Segment length: 84</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points: 42 (50% overlap)</span>
<span class="r-plt img"><img src="eeg_filter-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="plot_psd.html">plot_psd</a></span><span class="op">(</span><span class="fu">eeg_filter</span><span class="op">(</span><span class="va">demo_epochs</span>, low_freq <span class="op">=</span> <span class="fl">12</span>, high_freq <span class="op">=</span> <span class="fl">8</span>, method <span class="op">=</span> <span class="st">"iir"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Band-stop IIR filter from 8 - 12 Hz.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Effective filter order: 4 (two-pass)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing channel means per epoch...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing Power Spectral Density using Welch's method.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> FFT length: 256</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Segment length: 84</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Overlapping points: 42 (50% overlap)</span>
<span class="r-plt img"><img src="eeg_filter-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matt Craddock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

