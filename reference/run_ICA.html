<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Independent Component Analysis for EEG data — run_ICA • eegUtils</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Independent Component Analysis for EEG data — run_ICA"><meta name="description" content="Performs Independent Component Analysis for electroencephalographic data.
Currently only available with on epoched data. Implements three different
methods of ICA - 'fastica', 'extended Infomax', and 'Second-Order Blind
Identification (SOBI)'. The resulting eeg_ICA objects can be used largely
like eeg_epochs objects."><meta property="og:description" content="Performs Independent Component Analysis for electroencephalographic data.
Currently only available with on epoched data. Implements three different
methods of ICA - 'fastica', 'extended Infomax', and 'Second-Order Blind
Identification (SOBI)'. The resulting eeg_ICA objects can be used largely
like eeg_epochs objects."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eegUtils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/eegUtils.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/data_structures.html">A guide to eegUtils data structures</a></li>
    <li><a class="dropdown-item" href="../articles/epoch-handling.html">Event and epoch handling</a></li>
    <li><a class="dropdown-item" href="../articles/linear_modelling/linear_modelling.html">Linear Modelling</a></li>
    <li><a class="dropdown-item" href="../articles/time-frequency-analysis.html">Frequency analysis</a></li>
    <li><a class="dropdown-item" href="../articles/topoplot/topoplot.html">Building a topographical plot</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/craddm/eegUtils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Independent Component Analysis for EEG data</h1>
      <small class="dont-index">Source: <a href="https://github.com/craddm/eegUtils/blob/v0.8.0/R/run_ICA.R" class="external-link"><code>R/run_ICA.R</code></a></small>
      <div class="d-none name"><code>run_ICA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs Independent Component Analysis for electroencephalographic data.
Currently only available with on epoched data. Implements three different
methods of ICA - 'fastica', 'extended Infomax', and 'Second-Order Blind
Identification (SOBI)'. The resulting <code>eeg_ICA</code> objects can be used largely
like <code>eeg_epochs</code> objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_ICA</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'eeg_epochs'</span></span>
<span><span class="fu">run_ICA</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"sobi"</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  pca <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centre <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alg <span class="op">=</span> <span class="st">"gradient"</span>,</span>
<span>  rateanneal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>  rate <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"weights"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data to be ICAed.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters passed to function.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>"sobi" (default), "fastica", "infomax", or "imax". "infomax"
uses the implementation from the <code>ica</code> package, whereas <code>imax</code> uses the
implementation from the <code>infomax</code> package, which is based on the <code>EEGLAB</code>
implementation.</p></dd>


<dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>Maximum number of iterations of the Infomax and Fastica ICA
algorithms.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Convergence tolerance for fastica and infomax. Defaults to 1e-06.</p></dd>


<dt id="arg-pca">pca<a class="anchor" aria-label="anchor" href="#arg-pca"></a></dt>
<dd><p>Reduce the number of dimensions using PCA before running ICA.
Numeric,  &gt;1 and &lt; number of channels</p></dd>


<dt id="arg-centre">centre<a class="anchor" aria-label="anchor" href="#arg-centre"></a></dt>
<dd><p>Defaults to TRUE. Centre the data on zero by subtracting the
column mean. See notes on usage.</p></dd>


<dt id="arg-alg">alg<a class="anchor" aria-label="anchor" href="#arg-alg"></a></dt>
<dd><p>Use "gradient descent" or "newton" algorithm for extended infomax.
Defaults to "gradient". Ignored if method != "infomax".</p></dd>


<dt id="arg-rateanneal">rateanneal<a class="anchor" aria-label="anchor" href="#arg-rateanneal"></a></dt>
<dd><p>Annealing rate for extended infomax. Ignored if method !=
"infomax".</p></dd>


<dt id="arg-rate">rate<a class="anchor" aria-label="anchor" href="#arg-rate"></a></dt>
<dd><p>Learning rate for extended infomax. Ignored if method !=
"infomax".</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Print informative messages to console.</p></dd>


<dt id="arg-return">return<a class="anchor" aria-label="anchor" href="#arg-return"></a></dt>
<dd><p>"full" or "weights". "full" returns the mixing and unmixing
matrices and the source timecourses. "weights" returns only the mixing and
unmixing matrices. Defaults to "full".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>eeg_ICA</code> object containing an ICA decomposition</p>
    </div>
    <div class="section level2">
    <h2 id="methods-by-class-">Methods (by class)<a class="anchor" aria-label="anchor" href="#methods-by-class-"></a></h2>

<ul><li><p><code>run_ICA(eeg_epochs)</code>: Run ICA on an <code>eeg_epochs</code> object</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="notes-on-ica-usage">Notes on ICA usage<a class="anchor" aria-label="anchor" href="#notes-on-ica-usage"></a></h2>



<p>It is recommended to mean-centre your data appropriately before running
ICA. The implementations of FASTICA and extended-Infomax from the <code>ica</code>
package, and of SOBI ICA have this as an option which is enabled by
default, while the implementation of FASTICA in the fICA package enforces
mean-centring of the columns of the data. With epoched data, it is
recommended to centre each epoch on zero, rather than centre on the overall
channel mean. This can be achieved with the <code><a href="rm_baseline.html">rm_baseline()</a></code> function. SOBI
ICA will do this automatically, whereas the other ICA implementations will
centre on the channel means, not the epoch means.</p>
<p>In addition, PCA will be required if the data is not full rank. This is
typical when using average reference, when the data rank will be
n_electrodes - 1.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other decompositions:
<code><a href="eeg_decompose.html">eeg_decompose</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Matt Craddock <a href="mailto:matt@mattcraddock.com">matt@mattcraddock.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sobi_demo</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">run_ICA</span><span class="op">(</span><span class="va">demo_epochs</span>,</span></span>
<span class="r-in"><span>          pca <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reducing data to 10 dimensions using PCA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running SOBI ICA.</span>
<span class="r-in"><span> <span class="va">sobi_demo</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Epoched ICA decomposition</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of components	: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of epochs	: 80 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Epoch limits		: -0.197 - 0.451 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling rate		: 128  Hz</span>
<span class="r-in"><span> <span class="co"># We can plot the resulting spatial filters using `topoplot()`</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="topoplot.html">topoplot</a></span><span class="op">(</span><span class="va">sobi_demo</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting 2 components</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using electrode locations from data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting head r 95 mm</span>
<span class="r-plt img"><img src="run_ICA-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span>  <span class="fu"><a href="view_ica.html">view_ica</a></span><span class="op">(</span><span class="va">sobi_demo</span><span class="op">)</span>  <span class="co"># \dontrun{}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matt Craddock.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

